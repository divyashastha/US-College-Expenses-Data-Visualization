<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Assign4_DivyaR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Assignment4_DivyaR_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment4_DivyaR_files/libs/quarto-html/quarto.js"></script>
<script src="Assignment4_DivyaR_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment4_DivyaR_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment4_DivyaR_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment4_DivyaR_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment4_DivyaR_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment4_DivyaR_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment4_DivyaR_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment4_DivyaR_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="Assignment4_DivyaR_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="Assignment4_DivyaR_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assign4_DivyaR</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="buan-5210-01-data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="buan-5210-01-data-visualization"><strong>BUAN 5210 01 DATA VISUALIZATION</strong></h3>
</section>
<section id="assignment-4-college-expenses-exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="assignment-4-college-expenses-exploratory-data-analysis">Assignment 4: College Expenses Exploratory Data Analysis</h3>
<p>Name: Divya Ramesh</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">list</span>(<span class="at">CRAN=</span><span class="st">"http://cran.rstudio.com/"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'plyr'</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/qs/zy_g7yb14yz6_0c7bw7t6h5c0000gq/T//Rtmpgd54RJ/downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">'tidyverse'</span> , <span class="st">'vtable'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/qs/zy_g7yb14yz6_0c7bw7t6h5c0000gq/T//Rtmpgd54RJ/downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'gghighlight'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/qs/zy_g7yb14yz6_0c7bw7t6h5c0000gq/T//Rtmpgd54RJ/downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'causaldata'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/qs/zy_g7yb14yz6_0c7bw7t6h5c0000gq/T//Rtmpgd54RJ/downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>, <span class="at">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    /var/folders/qs/zy_g7yb14yz6_0c7bw7t6h5c0000gq/T//Rtmpgd54RJ/downloaded_packages</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6      ✔ dplyr   1.0.10
✔ tibble  3.1.8      ✔ stringr 1.4.1 
✔ readr   2.1.3      ✔ forcats 0.5.2 
✔ purrr   0.3.5      
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::arrange()   masks plyr::arrange()
✖ purrr::compact()   masks plyr::compact()
✖ dplyr::count()     masks plyr::count()
✖ dplyr::failwith()  masks plyr::failwith()
✖ dplyr::filter()    masks stats::filter()
✖ dplyr::id()        masks plyr::id()
✖ dplyr::lag()       masks stats::lag()
✖ dplyr::mutate()    masks plyr::mutate()
✖ dplyr::rename()    masks plyr::rename()
✖ dplyr::summarise() masks plyr::summarise()
✖ dplyr::summarize() masks plyr::summarize()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vtable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: kableExtra

Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghighlight)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(causaldata)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Read the File and generate a Variable Table</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'college_expenses_and_enrollment.Rdata'</span>) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vtable<span class="sc">::</span><span class="fu">vtable</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>df</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Name </th>
   <th style="text-align:left;"> Class </th>
   <th style="text-align:left;"> Label </th>
   <th style="text-align:left;"> Values </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> UNITID </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> College ID </td>
   <td style="text-align:left;"> Num: 100654 to 491118 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> STABBR </td>
   <td style="text-align:left;"> factor </td>
   <td style="text-align:left;"> State </td>
   <td style="text-align:left;"> 'AK' 'AL' 'AR' 'AS' 'AZ' and more </td>
  </tr>
  <tr>
   <td style="text-align:left;"> type </td>
   <td style="text-align:left;"> factor </td>
   <td style="text-align:left;"> College Type (NP = Nonprofit) </td>
   <td style="text-align:left;"> 'For-Profit 2-Year' 'For-Profit 4-Year' 'Private NP 2-Year' 'Private NP 4-Year' 'Public 2-Year' and more </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total.Income </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Total Income </td>
   <td style="text-align:left;"> Num: 6067 to 9703300000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total.Expenses </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Total Expenses </td>
   <td style="text-align:left;"> Num: 4600 to 8629847000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tuition </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Tuition (Income) </td>
   <td style="text-align:left;"> Num: 0 to 1753736000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Federal </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Federal Support (Income) </td>
   <td style="text-align:left;"> Num: 0 to 1071432208 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> State </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> State Support (Income) </td>
   <td style="text-align:left;"> Num: 0 to 909496000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Local </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Local Support (Income) </td>
   <td style="text-align:left;"> Num: 0 to 386724142 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Private </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Private Support (Income) </td>
   <td style="text-align:left;"> Num: -246016 to 1568865000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Sales </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Sales (Income) </td>
   <td style="text-align:left;"> Num: -1073664 to 8471746000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Research </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Research (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 2910863000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Public.Service </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Public Service (Expense) </td>
   <td style="text-align:left;"> Num: -32 to 807399000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Student.Services </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Student Services (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 284363000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Instruction </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Instruction (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 2611938000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Academic.Support </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Academic Support (Expense) </td>
   <td style="text-align:left;"> Num: 0 to 919577000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Other </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> Other Expenses </td>
   <td style="text-align:left;"> Num: -1 to 5543912000 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Institution.Name </td>
   <td style="text-align:left;"> character </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;">  </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Total.Enrollment </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;"> Num: 9 to 131629 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Full.Time.Enrollment </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;"> Num: 0 to 131629 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Undergraduate.Enrollment </td>
   <td style="text-align:left;"> numeric </td>
   <td style="text-align:left;"> NULL </td>
   <td style="text-align:left;"> Num: 0 to 103711 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Executing summary Statistics to understand the data in general</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     UNITID           STABBR                    type       Total.Income      
 Min.   :100654   CA     : 468   For-Profit 2-Year: 754   Min.   :6.067e+03  
 1st Qu.:157674   NY     : 324   For-Profit 4-Year: 477   1st Qu.:6.043e+06  
 Median :203614   TX     : 272   Private NP 2-Year: 159   Median :2.370e+07  
 Mean   :247693   PA     : 239   Private NP 4-Year:1628   Mean   :1.255e+08  
 3rd Qu.:366433   FL     : 228   Public 2-Year    : 992   3rd Qu.:7.395e+07  
 Max.   :491118   OH     : 223   Public 4-Year    : 761   Max.   :9.703e+09  
                  (Other):3017                                               
 Total.Expenses         Tuition             Federal         
 Min.   :4.600e+03   Min.   :0.000e+00   Min.   :0.000e+00  
 1st Qu.:3.202e+06   1st Qu.:2.329e+06   1st Qu.:6.854e+05  
 Median :1.450e+07   Median :7.655e+06   Median :2.536e+06  
 Mean   :1.010e+08   Mean   :3.559e+07   Mean   :1.247e+07  
 3rd Qu.:5.072e+07   3rd Qu.:2.594e+07   3rd Qu.:8.038e+06  
 Max.   :8.630e+09   Max.   :1.754e+09   Max.   :1.071e+09  
                                                            
     State               Local              Private          
 Min.   :        0   Min.   :        0   Min.   :   -246016  
 1st Qu.:        0   1st Qu.:        0   1st Qu.:         0  
 Median :   883000   Median :        0   Median :    320041  
 Mean   : 17874966   Mean   :  3421588   Mean   :  10226745  
 3rd Qu.: 11440117   3rd Qu.:    67965   3rd Qu.:   3145640  
 Max.   :909496000   Max.   :386724142   Max.   :1568865000  
                                                             
     Sales               Research         Public.Service     
 Min.   :  -1073664   Min.   :0.000e+00   Min.   :      -32  
 1st Qu.:         0   1st Qu.:0.000e+00   1st Qu.:        0  
 Median :    102720   Median :0.000e+00   Median :        0  
 Mean   :  45901782   Mean   :1.234e+07   Mean   :  3893081  
 3rd Qu.:   9142570   3rd Qu.:1.228e+04   3rd Qu.:   445858  
 Max.   :8471746000   Max.   :2.911e+09   Max.   :807399000  
                                                             
 Student.Services     Instruction        Academic.Support   
 Min.   :        0   Min.   :0.000e+00   Min.   :        0  
 1st Qu.:   544548   1st Qu.:1.552e+06   1st Qu.:   347380  
 Median :  2770299   Median :7.589e+06   Median :  1716867  
 Mean   :  8628289   Mean   :3.769e+07   Mean   : 10321013  
 3rd Qu.:  8839072   3rd Qu.:2.713e+07   3rd Qu.:  6072095  
 Max.   :284363000   Max.   :2.612e+09   Max.   :919577000  
                                                            
     Other            Institution.Name   Total.Enrollment  
 Min.   :        -1   Length:4771        Min.   :     9.0  
 1st Qu.:         0   Class :character   1st Qu.:   365.5  
 Median :     35172   Mode  :character   Median :  1573.0  
 Mean   :  28176156                      Mean   :  4646.3  
 3rd Qu.:   5461534                      3rd Qu.:  4993.0  
 Max.   :5543912000                      Max.   :131629.0  
                                         NA's   :516       
 Full.Time.Enrollment Undergraduate.Enrollment
 Min.   :     0.0     Min.   :     0          
 1st Qu.:   263.5     1st Qu.:   279          
 Median :   972.0     Median :  1384          
 Mean   :  2850.4     Mean   :  3956          
 3rd Qu.:  2701.5     3rd Qu.:  4312          
 Max.   :131629.0     Max.   :103711          
 NA's   :516          NA's   :516             </code></pre>
</div>
</div>
<p>With the below comments, I am creating new variables (columns) to calculate the Total Income and Expenses per capita, Overall income and expenses of individual colleges, overall income and expenses per capita.</p>
<p>Then, I wanted to find the profit per capita for each college so that I will know how profitable universities are functioning and I thought to use this information for doing some useful analysis thereafter.</p>
<p>Lastly, I calculated Tuition per capita.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Total_Income_Per_Capita'</span> <span class="ot">=</span> Total.Income<span class="sc">/</span>Total.Enrollment) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Total_Expenses_Per_Capita'</span> <span class="ot">=</span> Total.Expenses<span class="sc">/</span>Total.Enrollment) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Overall.Income'</span> <span class="ot">=</span> Total.Income <span class="sc">+</span> Tuition <span class="sc">+</span> Federal <span class="sc">+</span> State <span class="sc">+</span> Local <span class="sc">+</span> Private <span class="sc">+</span> Sales) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Overall.Expenses'</span> <span class="ot">=</span> Total.Expenses <span class="sc">+</span> Research <span class="sc">+</span> Public.Service <span class="sc">+</span> Student.Services <span class="sc">+</span> Instruction <span class="sc">+</span> Academic.Support <span class="sc">+</span> Other) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Overall_Income_Per_Capita'</span> <span class="ot">=</span> Overall.Income<span class="sc">/</span>Total.Enrollment) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Overall_Expenses_Per_Capita'</span> <span class="ot">=</span> Overall.Expenses<span class="sc">/</span>Total.Enrollment) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Profit_Per_Capita'</span> <span class="ot">=</span> Overall_Income_Per_Capita <span class="sc">-</span> Overall_Expenses_Per_Capita) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">'Tuition_Per_Capita'</span> <span class="ot">=</span> Tuition<span class="sc">/</span>Total.Enrollment)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 29
  UNITID STABBR type       Total…¹ Total…² Tuition Federal  State  Local Private
   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 100654 AL     Public 4-…  1.59e8  1.03e8  4.65e7  4.52e7 4.22e7 0       2.28e6
2 100663 AL     Public 4-…  2.96e9  2.69e9  2.09e8  3.85e8 2.83e8 2.35e6  1.06e8
3 100690 AL     Private N…  8.32e6  3.56e6  6.60e6  9.04e5 0      0       7.78e5
4 100706 AL     Public 4-…  2.26e8  1.95e8  6.24e7  8.04e7 5.20e7 0       5.59e6
5 100724 AL     Public 4-…  1.33e8  8.94e7  4.53e7  2.84e7 4.66e7 0       2.91e6
6 100751 AL     Public 4-…  1.18e9  9.05e8  4.83e8  7.20e7 1.86e8 1.02e6  6.00e7
# … with 19 more variables: Sales &lt;dbl&gt;, Research &lt;dbl&gt;, Public.Service &lt;dbl&gt;,
#   Student.Services &lt;dbl&gt;, Instruction &lt;dbl&gt;, Academic.Support &lt;dbl&gt;,
#   Other &lt;dbl&gt;, Institution.Name &lt;chr&gt;, Total.Enrollment &lt;dbl&gt;,
#   Full.Time.Enrollment &lt;dbl&gt;, Undergraduate.Enrollment &lt;dbl&gt;,
#   Total_Income_Per_Capita &lt;dbl&gt;, Total_Expenses_Per_Capita &lt;dbl&gt;,
#   Overall.Income &lt;dbl&gt;, Overall.Expenses &lt;dbl&gt;,
#   Overall_Income_Per_Capita &lt;dbl&gt;, Overall_Expenses_Per_Capita &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>I also tried to find the correlation between overall expenses and overall income - A correlation of 0.98 shows that both entities are highly correlated, which means that an income for a college is almost always offset by its expenditure. Then, are colleges not running on profit?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data1<span class="sc">$</span>Overall.Income, data1<span class="sc">$</span>Overall.Expenses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9840967</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Overall.Income <span class="sc">~</span> Overall.Expenses, <span class="at">data =</span> data1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Overall.Income ~ Overall.Expenses, data = data1)

Coefficients:
     (Intercept)  Overall.Expenses  
       2.569e+07         1.115e+00  </code></pre>
</div>
</div>
<p><strong>DATA ANALYSIS 1</strong></p>
<p>This leads to my first analysis: Institutional Profit per capita vs Type of Institutions</p>
<p>From the bar chart below, we can observe that Private non-profit (4 year) type of college makes more profit compared to other institutions. As expected, the public colleges make the least profit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Institutional_Profit_Per_Capita =</span> <span class="fu">mean</span>(Profit_Per_Capita, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>Institutional_Profit_Per_Capita) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(type, <span class="sc">-</span>Institutional_Profit_Per_Capita) , <span class="at">y =</span> Institutional_Profit_Per_Capita)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">'dodge'</span>) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">fill=</span><span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Type of Institution"</span>) <span class="sc">+</span>  </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Institution Profit Per Capita"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment4_DivyaR_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>DATA ANALYSIS 2</strong></p>
<p>Here, I have done a scatter-plot to analyse the relationship between Overall Income and the amount of money spent on Research (R&amp;D). There is a positive correlation (corr=0.81), which shows that colleges allocate funds to research based on the amount of income they generate.</p>
<p>I noticed an anomaly in the data - John Hopkins college (a point on the top left quandrant) spends a significant amount of approximately USD 2.91Billion for research. I researched a little more on this topic, and I was surprised to find that Johns Hopkins has led all US universities in R&amp;D spending for 42 consecutive year.</p>
<section id="reference-hub---john-hopkins-university.-2022-jan-7.-retrieved-from-httpshub.jhu.edu20220107nsf-higher-education-research-spending-2020textthe20university20spent20a20recordthe20next20highest2dspending20institution." class="level5">
<h5 class="anchored" data-anchor-id="reference-hub---john-hopkins-university.-2022-jan-7.-retrieved-from-httpshub.jhu.edu20220107nsf-higher-education-research-spending-2020textthe20university20spent20a20recordthe20next20highest2dspending20institution.">Reference: <em>Hub - John Hopkins University</em>. (2022, Jan 7). Retrieved from https://hub.jhu.edu/2022/01/07/nsf-higher-education-research-spending 2020/#:~:text=The%20university%20spent%20a%20record,the%20next%20highest%2Dspending%20institution.</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Overall.Income, <span class="at">y =</span> Research)) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">unit_format</span>(<span class="at">unit =</span> <span class="st">"M"</span>, <span class="at">scale =</span> <span class="fl">1e-6</span>)) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">unit_format</span>(<span class="at">unit =</span> <span class="st">"M"</span>, <span class="at">scale =</span> <span class="fl">1e-6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment4_DivyaR_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data1<span class="sc">$</span>Overall.Income, data1<span class="sc">$</span>Research)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8134737</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>Research) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 29
  UNITID STABBR type       Total…¹ Total…² Tuition Federal  State  Local Private
   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 162928 MD     Private N…  3.55e9  5.13e9  6.11e8  2.10e7 9.73e6 7.66e6  1.57e9
# … with 19 more variables: Sales &lt;dbl&gt;, Research &lt;dbl&gt;, Public.Service &lt;dbl&gt;,
#   Student.Services &lt;dbl&gt;, Instruction &lt;dbl&gt;, Academic.Support &lt;dbl&gt;,
#   Other &lt;dbl&gt;, Institution.Name &lt;chr&gt;, Total.Enrollment &lt;dbl&gt;,
#   Full.Time.Enrollment &lt;dbl&gt;, Undergraduate.Enrollment &lt;dbl&gt;,
#   Total_Income_Per_Capita &lt;dbl&gt;, Total_Expenses_Per_Capita &lt;dbl&gt;,
#   Overall.Income &lt;dbl&gt;, Overall.Expenses &lt;dbl&gt;,
#   Overall_Income_Per_Capita &lt;dbl&gt;, Overall_Expenses_Per_Capita &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p><strong>DATA ANALYSIS 3</strong></p>
<p>As an international student, I wanted to find out how much students spend in each state on average for their tuition fees. I have created a bar chart for top 10 American states with the highest tuition fee. I have ranked the data in the order of most expensive tuitions per state to the least. I was surprised to find that Fermont (VT) state has some expensive universities, as I was under the impression that Massachusetts (MA) or even New York (NY) would top the list, given the cost of living and some of the best universities in the US situated in those states.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STABBR) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Avg_Tuition_Per_State_Per_Capita =</span> <span class="fu">mean</span>(Tuition_Per_Capita, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>Avg_Tuition_Per_State_Per_Capita) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(STABBR, <span class="sc">-</span>Avg_Tuition_Per_State_Per_Capita), <span class="at">y =</span> Avg_Tuition_Per_State_Per_Capita)) <span class="sc">+</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">'dodge'</span>, <span class="at">fill=</span><span class="st">'lightblue'</span>) <span class="sc">+</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(<span class="fu">max</span>(Avg_Tuition_Per_State_Per_Capita) <span class="sc">&gt;</span> <span class="dv">25000</span>) <span class="sc">+</span> </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%0.2f"</span>, <span class="fu">round</span>(Avg_Tuition_Per_State_Per_Capita, <span class="at">digits =</span> <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"American States"</span>) <span class="sc">+</span>  </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Average Tuition Per State Per Student"</span>) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Top 10 States with Highest Average Tuition Fee"</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">'bold'</span>),<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">'bold'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Assignment4_DivyaR_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>